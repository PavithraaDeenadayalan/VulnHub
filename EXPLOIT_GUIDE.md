## MedVulnLab Exploit Guide (Educational)

> ⚠️ For lab use only. Do not deploy or use against real systems.

This guide shows how to capture flags for the three active modules (A01, A03, A05) across all four levels. Each level explains the mistake and the minimal steps to trigger the flag.

---

### A01 – Broken Access Control

**LOW – Missing Relationship Validation**
- Role: Doctor (`dr_smith` or `dr_jones`).
- Navigate: Sidebar → A01 → Level 1 (LOW).
- Action: In the patient dropdown, pick a patient NOT assigned to your doctor account (e.g., `dr_smith` selects `pat004` or `pat005`).
- Flag trigger: Viewing an unassigned patient record sets the flag.

**MEDIUM – Frontend-Only Access Control**
- Role: Any non-doctor (e.g., `patient_alice`, `lab_tech`, `billing_officer`).
- Navigate: Sidebar → A01 → Level 2 (MEDIUM).
- Bypass UI:
  - In DevTools, remove `disabled` from the patient select and textarea, OR
  - Send a direct POST to `medium.php` with `action=create_prescription`, `patient_id=pat001`, `prescription=anything`.
- Flag trigger: Creating a prescription as a non-doctor.

**HARD – Workflow State Bypass**
- Roles to try: `lab_tech`, `billing_officer`, `dr_smith`.
- Navigate: Sidebar → A01 → Level 3 (HARD).
- Intended flow: diagnosis → lab_report → billing_approval → completed.
- Bypass: Perform actions out of order on the same `report_id`:
  - As `billing_officer`, click “Approve Billing” even if state is not `lab_report`.
  - Or as `doctor`, click “Complete Workflow” before billing approval.
- Flag trigger: Successful action while workflow is in the wrong state.

**IMPOSSIBLE – Token Reuse Without Ownership Revalidation**
- Role: `billing_officer`.
- Navigate: Sidebar → A01 → Level 4 (IMPOSSIBLE).
- Tokens are prefilled and not bound to session/ownership.
- Bypass:
  - Use a token from one billing record to approve another (or reuse the visible token directly).
  - Submit the form with any valid-looking token for any `billing_id` (pre-filled works).
- Flag trigger: Approving with a reused/any token (no ownership check).

---

### A03 – Injection

**LOW – Array Search Injection**
- Navigate: Sidebar → A03 → Level 1 (LOW).
- The search uses raw input; to return all patients, search with a broad term:
  - Try `%` or ` ` (space) or a letter common to all (e.g., `a`).
- Flag trigger: Search that returns all patient records.

**MEDIUM – Path Traversal / File Access**
- Navigate: Sidebar → A03 → Level 2 (MEDIUM).
- Input: `file` path (relative to `data/`).
- Bypass reports sandbox with traversal, e.g.:
  - `../config/security.php`
  - `../data/seed.php`
- Flag trigger: Accessing a file outside `data/reports/`.

**HARD – PHP Object Deserialization**
- Navigate: Sidebar → A03 → Level 3 (HARD).
- The form unserializes raw input. Supply a serialized object that triggers a side effect (writes `.flag_check`).
- Example payload (paste into textarea):
  ```
  O:8:"stdClass":1:{s:4:"ping";s:11:".flag_check";}
  ```
  (Any payload that causes file creation named `.flag_check` in `data/` works for the flag.)
- Flag trigger: Code path that creates `.flag_check` (simulated code execution).

**IMPOSSIBLE – Second-Order Injection / Stored Payload**
- Navigate: Sidebar → A03 → Level 4 (IMPOSSIBLE).
- Add a note containing PHP-like markers so the viewer logic treats it as dangerous:
  - Example note: `<?php echo "pwn"; ?>`
- Then click “View” on that note.
- Flag trigger: Viewing a stored malicious note (simulated execution check).

---

### A05 – Security Misconfiguration

**LOW – Debug Mode & Verbose Errors**
- Navigate: Sidebar → A05 → Level 1 (LOW).
- Click “Trigger Error” to show verbose stack trace, or “Access Config”.
- Flag trigger: Accessing the sensitive config view (`?sensitive=config` link).

**MEDIUM – Default Credentials**
- Navigate: Sidebar → A05 → Level 2 (MEDIUM).
- Login form accepts default weak admin creds. Try:
  - `admin / admin123`
- Flag trigger: Successful login with default credentials.

**HARD – Predictable IDs & Missing Authorization (IDOR)**
- Navigate: Sidebar → A05 → Level 3 (HARD).
- Patient IDs are predictable (`pat001`, `pat002`, ...).
- As any user, request a patient you shouldn’t access (e.g., if you’re `dr_smith`, open `pat004`; if you’re a patient, open any other `patXXX`).
- Flag trigger: Viewing a record you’re not authorized to see.

**IMPOSSIBLE – Insecure File Permissions & Directory Listing**
- Navigate: Sidebar → A05 → Level 4 (IMPOSSIBLE).
- Path input defaults to `data/`. Enumerate:
  - Browse `data/` then open `backup_config.php.bak` or `.secret_key.txt`
  - Or directly request `data/backup_config.php.bak`
- Flag trigger: Reading a sensitive/backup/secret file.

---

### Quick flag check
- Flags are stored per session; counter shows in the sidebar.
- Each level displays a flag banner when triggered.

Happy (responsible) hacking!  
